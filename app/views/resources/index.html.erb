<!-- <% form_tag resources_path, :method => 'get' do %>
  <p>
    <%= text_field_tag :search, params[:tag] %>
    <%= submit_tag "Search", :name => nil %>
  </p>
<% end %> -->

<%= form_tag(resources_path, :method => "get") do %>
  <p>
    <%= text_field_tag :tag, params[:tag] %>
    <%= submit_tag "Search", :name => nil %>
  </p> 
<% end %>

<h1>Resources</h1>

<ul>
  <% @resources.each do |resource| %>
    <li>
      <%= link_to resource.title, resource.link, :target => "_blank" %><br />
      <%= resource.description %><br />
        <%= pluralize resource.reputation_for(:votes).to_i, "vote" %>
        <% if current_user && !current_user.voted_for?(resource) %>
	| <%= link_to "up", vote_resource_path(resource, type: "up"), method: "post" %>
	| <%= link_to "down", vote_resource_path(resource, type: "down"), method: "post" %>
	<% end %><br />
      Tags: <%= raw resource.tags.map(&:name).map { |t| link_to t, tag_path(t) }.join(', ') %>
    </li>
  <% end %>
</ul>

<% if user_signed_in? %>
   
<%= form_for(@resource) do |f| %>
  <p>
    <%= f.label :title %><br />
    <%= f.text_field :title %>
  </p>
  <p>
    <%= f.label :description %><br />
    <%= f.text_area :description %>
  </p>
  <p>
    <%= f.label :link %><br />
    <%= f.text_field :link %>
  </p>
  <p>
    <%= f.label :tag_list, "Tags (separated by commas)" %><br />
    <%= f.text_field :tag_list %>
  </p>
  <p>
    <%= f.submit %>
  </p>
<% end %>

<% else %>
    <%= link_to "Sign in to add resources", new_user_session_path %>
<% end %>

